# massive_expansion_improved.py - ูุธุงู ุงูุชูุณูุน ุงูุถุฎู ุงููุญุณู ููุงูู
import json
import random
import itertools
from typing import List, Dict, Set
from continuous_learning import ContinuousLearningSystem

class ImprovedMassiveExpansion(ContinuousLearningSystem):
    """ูุธุงู ุงูุชูุณูุน ุงูุถุฎู ุงููุญุณู ูููุตูู ุฅูู 15000+ ุฌููุฉ ูุฑูุฏุฉ"""
    
    def __init__(self, target_sentences: int = 15000, verbose: bool = True):
        super().__init__(verbose=verbose)
        self.target_sentences = target_sentences
        
    def generate_smart_variations(self, base_sentences: List[str], target_count: int) -> List[str]:
        """ุชูููุฏ ุชูููุนุงุช ุฐููุฉ ููุชุทูุฑุฉ ูู ุงูุฌูู ุงูุฃุณุงุณูุฉ"""
        variations = set()  # ุงุณุชุฎุฏุงู set ูุถูุงู ุนุฏู ุงูุชูุฑุงุฑ
        
        # ููููุงุช ุงูุชูููุน ุงูุฐูู
        time_variations = ["ุงูููู", "ุงูุจุงุฑุญ", "ุจูุฑุฉ", "ุงูุตุจุญ", "ุงููุณุง", "ุงูุนุตุฑ", "ุงููุฌุฑ", "ุงููุบุฑุจ", "ุงูุถุญู", "ุงูุนุดุฑ", "ุงูููู"]
        emotion_variations = ["ูุจุณูุท", "ูุฑุญุงู", "ุณุนูุฏ", "ูุฑุชุงุญ", "ูุงุฏู", "ูุทูุฆู", "ุฑุงุถู", "ููุดุฑุญ", "ูุจููุฑ", "ูุนุฌุจ", "ูุชุญูุณ"]
        family_variations = ["ุฃูู", "ุฃุจูู", "ุฃุฎุชู", "ุฃุฎูู", "ุฌุฏู", "ุฌุฏุชู", "ุงูุนุงุฆูุฉ", "ุงูุฃูู", "ุงูููุฏ", "ุงูุจูุช", "ุงูุนู", "ุงูุฎุงู"]
        place_variations = ["ุงูุจูุช", "ุงููุณุฌุฏ", "ุงูุดุงุฑุน", "ุงูุญู", "ุงูุณูู", "ุงูุฌุงูุนุฉ", "ุงููุฏุฑุณุฉ", "ุงูุนูู", "ุงูุญุฏููุฉ", "ุงูููุชุจ"]
        
        # ุชูููุนุงุช ุงูุจุฏุงูุงุช ูุงูููุงูุงุช
        prefixes = [
            "", "ุงูุญูุฏููู ", "ูุงููู ", "ุฃุญูุฏ ุงููู ", "ุจุตุฑุงุญุฉ ", "ุตุฏููู ", 
            "ุฃูุณู ุจุงููู ", "ูู ููุจู ", "ุจูู ุฃูุงูุฉ ", "ูุงููู ุงูุนุธูู ",
            "ุฅู ุดุงุก ุงููู ", "ุจุฅุฐู ุงููู ", "ูุง ุฑุจ ", "ุงูููู "
        ]
        
        suffixes = [
            "", " ูุงูุญูุฏููู", " ุฅู ุดุงุก ุงููู", " ุจุฅุฐู ุงููู", " ุฑุจู ููุฑูู", 
            " ุงููู ูุนุทูู ุงูุนุงููุฉ", " ุฌุฒุงู ุงููู ุฎูุฑ", " ูุง ูุตุฑุช", 
            " ุชุณูู ุฅูุฏู", " ุจุงุฑู ุงููู ููู", " ูุซุฑ ุฎูุฑู", " ุฒุงุฏู ุงููู ููุฑ"
        ]
        
        # ุชูููุฏ ุงูุชูููุนุงุช ุงููุชูุฏูุฉ
        for base in base_sentences:
            # ุชูููุนุงุช ูุจุงุดุฑุฉ ุฃููู
            for _ in range(target_count // len(base_sentences) + 5):
                varied = base
                
                # ุงุณุชุจุฏุงูุงุช ุฐููุฉ ูุชุนุฏุฏุฉ ุงููุณุชููุงุช
                for old_word, replacements in [
                    ("ุงูููู", time_variations),
                    ("ูุฑุญุงู", emotion_variations), 
                    ("ูุจุณูุท", emotion_variations),
                    ("ุฃูู", family_variations),
                    ("ุงูุจูุช", place_variations)
                ]:
                    if old_word in varied:
                        varied = varied.replace(old_word, random.choice(replacements))
                
                # ุฅุถุงูุฉ ุชูููุนุงุช ูู ุงูููุฏูุฉ ูุงูุฎุงุชูุฉ
                prefix = random.choice(prefixes)
                suffix = random.choice(suffixes)
                final_variation = prefix + varied + suffix
                
                variations.add(final_variation.strip())
                
                # ุชูููุนุงุช ุฅุถุงููุฉ ุจุชุบููุฑุงุช ูููููุฉ
                if len(variations) < target_count:
                    # ุชูููุน ูู ุงูุตูุบุฉ
                    if "ููุช" in varied:
                        structural_var = varied.replace("ููุช", random.choice(["ุตุญูุช", "ููุช", "ูุนุฏุช ูู ุงูููู"]))
                        variations.add(prefix + structural_var + suffix)
                    
                    if "ุณููุช" in varied:
                        structural_var = varied.replace("ุณููุช", random.choice(["ุนููุช", "ููุช ุจู", "ุฃูุฌุฒุช"]))
                        variations.add(prefix + structural_var + suffix)
                    
                    if "ุญุณูุช" in varied:
                        structural_var = varied.replace("ุญุณูุช", random.choice(["ุดุนุฑุช", "ุฃุญุณุณุช", "ูููุช ููุณู"]))
                        variations.add(prefix + structural_var + suffix)
                
                if len(variations) >= target_count:
                    break
            
            if len(variations) >= target_count:
                break
        
        return list(variations)[:target_count]
    
    def generate_daily_life_massive(self) -> List[str]:
        """ุชูููุฏ ุฌูู ุงูุญูุงุฉ ุงูููููุฉ ุงูุถุฎูุฉ"""
        base_daily = [
            "ููุช ูู ุงูููู ุนูู ุตูุช ุงูุฃุฐุงู", "ุดุฑุจุช ูููุชู ุงูุนุฑุจูุฉ ูุฃูุง ุฃุดูู ุงูุทููุฑ",
            "ุงููุฌุฑ ุงูููู ูุงู ุฌููู ูุงูุฌู ููุนุด", "ุจุฏูุช ูููู ุจุงูุจุณููุฉ", "ุตููุช ุงููุฌุฑ ูู ุงููุณุฌุฏ",
            "ุงููุบุฑุจ ุงูููู ูุงู ูุงุฏู", "ุณูุฑุช ูุน ุงูุฃูู ููุถููุง ููุช ุญูู", "ููุช ูุจูุฑ ุนุดุงู ุฃููู ูุดูุท",
            "ุงุณุชุบูุฑุช ูุจู ุงูููู", "ุงุดุชุบูุช ูู ุงูุจูุช ููุธูุช", "ุทุจุฎุช ูุฌุจุฉ ูุฐูุฐุฉ ูุนุงุฆูุชู",
            "ุบุณูุช ุงูููุงุจุณ ููููุชูุง", "ุณููุช ุงููุจุงุชุงุช ูุนุชููุช ุจุงูุญุฏููุฉ", "ุฑุชุจุช ุงูููุชุจุฉ ููุฑูุช ูุชุงุจ",
            "ุดุงูุฏุช ุจุฑูุงูุฌ ูููุฏ", "ูุนุจุช ูุน ุงูุฃุทูุงู ูุถุญููุง", "ุงุณุชูุนุช ูููุฑุขู", "ุงุชุตูุช ุจุตุฏูู ูุฏูู",
            "ุชูุดูุช ูู ุงูุญู ูุณููุช ุนูู ุงูุฌูุฑุงู", "ุญุณูุช ุจุงูุงูุชูุงู ููุนู ุงููู", "ูุฑุญุช ูุฃู ูููู ูุงู ุญูู",
            "ุชุนุจุช ุดูู ุจุณ ูุฑุชุงุญ", "ุญุณูุช ุจุงูุฑุถุง", "ุงุณุชูุชุนุช ุจุงูููุช", "ุดุนุฑุช ุจุงูุทูุฃูููุฉ",
            "ุญูุฏุช ุงููู ุนูู ุงูุตุญุฉ", "ุณุนุฏุช ูุฃู ุชุนููุช ุดู ุฌุฏูุฏ", "ุฃุนุฌุจูู ููุงู ุญูู ุณูุนุชู",
            "ุชุฃุซุฑุช ูู ูุตุฉ ูุคุซุฑุฉ", "ูุงุฑุณุช ุงูุฑูุงุถุฉ ูู ุงูุตุจุงุญ", "ุฃููุช ูุทูุฑ ุตุญู ููุฐูุฐ",
            "ุฒุฑุช ุงูุฃูุงุฑุจ ููุถูุช ูุนูู ููุช ุฌููู", "ุณุงุนุฏุช ุฌุงุฑู ูู ููุถูุน", "ุชุณููุช ูู ุงูุณูู ุงูุดุนุจู",
            "ุฌูุณุช ูู ุงูุจููููุฉ ุฃุชุฃูู ุงูุทุจูุนุฉ", "ุฑุชุจุช ุฃูุฑุงูู ููุณุชูุฏุงุชู", "ูุธูุช ุงูุณูุงุฑุฉ ูููุนุชูุง",
            "ุณูุนุช ุฃุฎุจุงุฑ ุญููุฉ ูุฑุญุช ููุง", "ุดุฑุจุช ุดุงู ูุน ุงููุนูุงุน", "ูุฑูุช ูู ุงูุฌูุงู ุฃุดูุงุก ูููุฏุฉ"
        ]
        return self.generate_smart_variations(base_daily, 2500)
    
    def generate_emotions_massive(self) -> List[str]:
        """ุชูููุฏ ุงููุดุงุนุฑ ุงููุชูุฏูุฉ ุงูุถุฎูุฉ"""
        base_emotions = [
            "ูุฑุญุงู ูุญุฒูู ูู ููุณ ุงูููุช", "ุฎุงูู ููุชุญูุณ ููุชุญุฏู ุงูุฌุฏูุฏ", "ูุดุชุงู ูุฃููู ูุฑุงุถู ุนู ูุฑุงุฑู",
            "ูุชุถุงูู ูู ุงููููู ุจุณ ูุงูู ุงูุญููุฉ", "ูุญุชุงุฑ ุจูู ุฎูุงุฑูู", "ูุจุณูุท ูู ุงูุฏุงุฎู ุฑุบู ุงูุชุนุจ",
            "ุญุงุณุณ ุจุงููุญุฏุฉ ุฑุบู ุฅูู ูุน ูุงุณ", "ูุงุฏู ูู ุจุฑุง ุจุณ ุฌูุงู ุนุงุตูุฉ", "ูุชูุงุฆู ุจุงููุณุชูุจู ุฑุบู ุงูุตุนูุจุฉ",
            "ูุญุจ ููุญูุงุฉ ุฑุบู ุงููุดุงูู", "ุดุนุฑุช ุจุญููู ุฎููู ููุทูููุฉ", "ุญุณูุช ุจูุฎุฑ ุตุงูุช", "ุชุฃุซุฑุช ูู ูุฑู ุดุฎุต ุบุฑูุจ",
            "ุงุณุชุงุก ูู ุทุฑููุฉ ุงูููุงู", "ุฃุนุฌุจุช ุจุงููุฏูุก ูู ุงูุนููู", "ุงูุชุงุจูู ุดุนูุฑ ุบุฑูุจ ุจุงูุญููู", "ุดุนุฑุช ุจุงูุฎุฌู ูู ุงูุซูุงุก",
            "ุชููููู ุฅุญุณุงุณ ุจุงููุณุคูููุฉ", "ุดุนุฑุช ุจุงูุถุนู ุฃูุงู ุนุธูุฉ ุงูุฎูู", "ุฃุญุณุณุช ุจุงูุทูุฃูููุฉ ูู ุงููุตุงุนุจ",
            "ุจููุช ูู ุงููุฑุญ ููุง ุณูุนุช ุงูุฎุจุฑ", "ุถุญูุช ูู ููุจู ุฃูู ูุฑุฉ ูู ุฒูุงู", "ุตุฑุฎุช ูู ุงูุฎูู", "ุณูุช ูุซูุฑ ูุฃูุง ุฃููุฑ",
            "ุนุถูุช ุนูู ุดูุชู ูู ุงูุบุถุจ", "ุบูุถุช ุนููู ูุชููุฏุช", "ุงุจุชุณูุช ุงุจุชุณุงูุฉ ุญุฒููุฉ", "ูุฒูุช ุฑุงุณู ุจุงูููุงููุฉ",
            "ุญุจุณุช ุฏูุนุชู ุนุดุงู ูุง ุฃุจูู", "ูุชุญุช ุนููู ุจุฏูุดุฉ", "ุงูุชูุฃ ููุจู ุจุงูุฑุญูุฉ", "ุดุนุฑุช ุจุงูุฐูุจ ุนูู ุชูุตูุฑู",
            "ุญุณูุช ุจุงููุฏู ุนูู ููุงู ููุชู", "ูุฎุฑุช ุจุฅูุฌุงุฒ ุญููุชู", "ุฎุฌูุช ูู ูุฏุญ ูุซูุฑ", "ุงูุจุณุทุช ูู ููุงุฌุฃุฉ ุญููุฉ",
            "ุญุฒูุช ุนูู ูุฑุงู ุนุฒูุฒ", "ุบุถุจุช ูู ุธูู ุดูุชู", "ุฎูุช ูู ุงููุณุชูุจู ุงููุฌููู", "ุงุทูุฃููุช ุจุนุฏ ููู ุทููู"
        ]
        return self.generate_smart_variations(base_emotions, 2000)
    
    def generate_social_massive(self) -> List[str]:
        """ุชูููุฏ ุงูุชูุงุนูุงุช ุงูุงุฌุชูุงุนูุฉ ุงูุถุฎูุฉ"""
        base_social = [
            "ุฌูุณุช ูุน ุตุฏููู ูุชููู ุนู ุฃุญูุงููุง", "ูุงูุดุช ูุน ุฃุจูู ููุถูุน ููู", "ุชุจุงุฏูุช ุงูุขุฑุงุก ูุน ุฒููุงุฆู",
            "ุงุณุชูุนุช ููุตุฉ ุฌุฏู ุนู ุงููุงุถู", "ุดุงุฑูุช ุชุฌุฑุจุชู ูุน ุดุฎุต", "ุทูุจุช ูุตูุญุฉ ูู ุฃูู", "ุฃุนุทูุช ุฑุฃูู ุจุตุฑุงุญุฉ",
            "ุชุนููุช ุดู ุฌุฏูุฏ ูู ูุญุงุฏุซุฉ", "ุดุฑุญุช ูุฌูุฉ ูุธุฑู", "ุงุณุชูุฏุช ูู ุชุฌุงุฑุจ ุงูุขุฎุฑูู", "ุฑุญุจุช ุจุงูุถููู ุจุญูุงูุฉ",
            "ุดูุฑุช ุงูุดุฎุต ุงููู ุณุงุนุฏูู", "ุงุนุชุฐุฑุช ุนู ุฎุทุฆู ุจุตุฏู", "ุจุงุฑูุช ูุตุฏููู ุฅูุฌุงุฒู", "ุนุฒูุช ุฌุงุฑู ูู ููุฏุงูู",
            "ููุฃุช ุฒูููู ุจุชุฑููุชู", "ูุฏูุช ูุงุฌุจ ุงูุนุฒุงุก", "ุฒุฑุช ูุฑูุถ ูุทูุฃูุช ุนูู ุตุญุชู", "ุฏุนูุช ุตุฏูู ูุญุถูุฑ ููุงุณุจุฉ",
            "ุดุงุฑูุช ูู ูุฑุญุฉ ูุฑูุจ", "ุชุฏุฎูุช ุจุญููุฉ ูู ูุดููุฉ", "ุตุงูุญุช ุจูู ุฃุฎููู", "ุญููุช ุฎูุงู ูู ุงูุนูู",
            "ูููุช ูููู ุนุงุฏู", "ุงูุชุฑุญุช ุญู ูุณุท", "ุชูุงุฒูุช ุนู ุญูู ูุฃุฌู ุงูุณูุงู", "ุงุนุชุฑูุช ุจุฎุทุฆู ูุทูุจุช ุงูุณูุงุญ",
            "ุณุงูุญุช ุดุฎุต ุฃุฐุงูู", "ุชุฌุงููุช ููุงู ุฌุงุฑุญ", "ุฏุนูุช ูููุฏูุก ูุงูุชูุงูู", "ูุตุญุช ุดุฎุต ุจุญููุฉ",
            "ุงุณุชุดุฑุช ุฃูู ุงูุฎุจุฑุฉ ูู ููุถูุน", "ุงุญุชุฑูุช ุฑุฃู ูุฎุงูู ุฑุฃูู", "ูุฏุฑุช ุธุฑูู ุดุฎุต ุตุนุจุฉ", "ูููุช ูุน ุงููุธููู",
            "ุฏุงูุนุช ุนู ุงูุญู ุจุฃุฏุจ", "ุฃูุฑูุช ุถูู ูู ุจูุชู", "ูุฏูุช ุฎุฏูุฉ ููุญุชุงุฌ", "ุณุงูุฏุช ุตุฏูู ูู ุฃุฒูุฉ"
        ]
        return self.generate_smart_variations(base_social, 2500)
    
    def generate_cultural_massive(self) -> List[str]:
        """ุชูููุฏ ุงูุชุนุจูุฑุงุช ุงูุซูุงููุฉ ุงูุถุฎูุฉ"""
        base_cultural = [
            "ุจูุชูุง ุจูุชู ููู ุงููู ุนูุฏูุง ูู", "ุฃููุงู ูุณููุงู ุจู ูุง ุฃูู ูููู", "ุนูู ุงูุฑุญุจ ูุงูุณุนุฉ ูุง ุบุงูู",
            "ุญูุงู ุงููู ูุฒุงุฏู ุฑูุนุฉ", "ุงููู ูุนุทูู ุงูุนุงููุฉ ูุงูููุฉ", "ุจุงุฑู ุงููู ููู ููู ุฃููู", "ุงููู ูุฌุนูู ูู ููุฒุงู ุญุณูุงุชู",
            "ุจุนุฏ ุฅุฐูู ุฅู ุดุงุก ุงููู", "ูุง ููุง ุจุงููู ููุฑ ุงูููุงู", "ูุซุฑ ุฎูุฑู ููู ุดุฑู", "ุฒุงุฏู ุงููู ูู ูุถูู ููุฑูู",
            "ุนูู ุจุฑูุฉ ุงูุฑุญูู ูุง ุฑุจ", "ูุง ูุตุฑุช ูุง ุฎูู ุฌุฒุงู ุงููู ุฎูุฑ", "ูุงููู ูุนุทูู ุนูู ูุฏ ููุชู",
            "ูุนุทูู ุงูุนุงููุฉ ูู ููุจู ูุฏููู", "ุงูุญูุฏููู ุงููู ุฌูุนูุง ุนูู ุฎูุฑ", "ูุง ุดุงุก ุงููู ุชุจุงุฑู ุงูุฑุญูู",
            "ุณุจุญุงู ุงููู ูุจุญูุฏู ุฑุจ ุงูุนุงูููู", "ุงููู ู ุญุฏ ุนููู ูุฃุฌูุญ ุงูุฎุงูู", "ูุฏุฑูุง ุนูุฏู ูุฅู ูู ุฒุงุฏูุง ุดุฑู",
            "ุนููู ุนูููุง ุจุงุฑุฏุฉ ูุง ุบุงูู", "ุนุณุงู ุนูู ุงูููุฉ ูุง ูู ุงูุทูุจ", "ุงููู ููููู ููู ุฎูุฑ", "ูู ุฌุฏ ูุฌุฏ ููู ุฒุฑุน ุญุตุฏ",
            "ุงูุตุจุฑ ููุชุงุญ ุงููุฑุฌ ุจุฅุฐู ุงููู", "ุงูุญูุฏููู ุฑุจ ุงูุนุงูููู ุนูู ูู ุงููุนู", "ูุง ุฅูู ุฅูุง ุงููู ูุญูุฏ ุฑุณูู ุงููู",
            "ุงูููู ุงุนุฒ ุงูุฅุณูุงู ูุงููุณูููู", "ุชูุจู ุงููู ููุง ููููู ุตุงูุญ ุงูุฃุนูุงู", "ูุง ูุฎููู ุชุฑูุญ ุฅูุง ุจุนุฏ ุงูุนุดุง",
            "ุงูุถูู ุนุฒูุฒ ููู ูู ุงูุชูุฏูุฑ", "ุฃููุงู ูุณููุงู ููุฉ ูุฑุญุจุง ููู", "ููุฑุช ุงูุจูุช ุจูุฌูุฏู ุงููุฑูู",
            "ุชูุถู ุงุฌุนู ููุณู ูู ุจูุชู", "ุนุณุงู ุนูู ุงูููุฉ ููุง ูุตุฑุช", "ุงููู ููุฑูู ุฒู ูุง ูุฑูุชูุง ุจุงูุฒูุงุฑุฉ"
        ]
        return self.generate_smart_variations(base_cultural, 2000)
    
    def generate_work_education_massive(self) -> List[str]:
        """ุชูููุฏ ุฌูู ุงูุนูู ูุงูุชุนููู ุงูุถุฎูุฉ"""
        base_work = [
            "ุญุถุฑุช ุงุฌุชูุงุน ููู ูู ุงูุดุฑูุฉ", "ุฃูุฌุฒุช ูุดุฑูุนู ูู ุงูุฌุงูุนุฉ", "ุชุนููุช ููุงุฑุฉ ุฌุฏูุฏุฉ", "ุฏุฑุณุช ูุงูุชุญุงู ููู",
            "ุนููุช ุจุฌุฏ ูุงุฌุชูุงุฏ", "ุดุงุฑูุช ูู ุฏูุฑุฉ ุชุฏุฑูุจูุฉ", "ุชุนุงููุช ูุน ุฒููุงุฆู ูู ุงูุนูู", "ูุฏูุช ุนุฑุถ ูููุฏูุฑ",
            "ูุฌุญุช ูู ุงูุงูุชุญุงู", "ุชุฎุฑุฌุช ูู ุงูุฌุงูุนุฉ", "ุญุตูุช ุนูู ุดูุงุฏุฉ", "ุจุฏุฃุช ูุธููุฉ ุฌุฏูุฏุฉ", "ุชุฑููุช ูู ุงูุนูู",
            "ุฃูููุช ุจุญุซู", "ุญุงุถุฑุช ูุคุชูุฑ ุนููู", "ุฐุงูุฑุช ุฏุฑูุณู ุจุชุฑููุฒ", "ุดุงุฑูุช ูู ุงูุญุตุฉ ุจูุนุงููุฉ", "ุณุงุนุฏุช ุฒููู ูุชุนูู",
            "ูุฑูุช ูุชุงุจ ูููุฏ ุฒุงุฏ ูุนุฑูุชู", "ุจุญุซุช ุนู ูุนูููุงุช ููุดุฑูุนู", "ุญุถุฑุช ูุญุงุถุฑุฉ ุซุฑูุฉ", "ูุงูุดุช ูุน ุงูุฃุณุชุงุฐ",
            "ุฑุงุฌุนุช ููุงุญุธุงุชู ููุงูุชุญุงู", "ุชุนููุช ููุงุฑุฉ ุชูููุฉ ุฌุฏูุฏุฉ", "ุดุฑุญุช ูุทุงูุจ ุตุบูุฑ ูุงุฌุจู", "ูุฌุญุช ูู ูุดุฑูุน ุตุนุจ",
            "ุญุตูุช ุนูู ุชูุฏูุฑ ููุชุงุฒ", "ุฑููุช ุจุณุจุจ ุงุฌุชูุงุฏู", "ูุฒุช ูู ูุณุงุจูุฉ ุซูุงููุฉ", "ุญููุช ูุฏู ูุงู ุตุนุจ",
            "ุชุฎุฑุฌุช ุจุฏุฑุฌุฉ ุงูุชูุงุฒ", "ุญุตูุช ุนูู ูุธููุฉ ุฃุญูุงูู", "ุฃูููุช ุงูุฏูุฑุฉ ุจูุฌุงุญ", "ูุฏูุช ุนุฑุถ ุฃุนุฌุจ ุงูุฌููุน"
        ]
        return self.generate_smart_variations(base_work, 1500)
    
    def generate_family_massive(self) -> List[str]:
        """ุชูููุฏ ุฌูู ุงูุนูุงูุงุช ุงูุนุงุฆููุฉ ุงูุถุฎูุฉ"""
        base_family = [
            "ุฃูู ุฃุญู ุฅูุณุงูุฉ ูู ุงูุฏููุง", "ุฃุจูู ูุฏูุชู ูู ุงูุญูุงุฉ", "ุฃุฎุชู ุฑูููุฉ ุฏุฑุจู", "ุฃุฎูู ุณูุฏู ูู ุงูุฏููุง",
            "ุฌุฏู ูุฏุฑุณุฉ ูู ุงูุญููุฉ", "ุฌุฏุชู ุญูุงููุง ูุฏุงูู ุงูุฌุฑูุญ", "ุงูุนุงุฆูุฉ ูู ุฃูู ุดู ูู ุญูุงุชู", "ุฃุญุจ ุฃููู ุฃูุซุฑ ูู ุฑูุญู",
            "ุฒุฑุช ุฃููู ููุถููุง ููุช ุญูู", "ุชุนููุช ูู ุชุฌุงุฑุจ ุงูุฃูู", "ูุฎูุฑ ุจุนุงุฆูุชู ูุฃุตูู", "ุฏุนูุงุช ุงููุงูุฏูู ุจุฑูุฉ",
            "ุจุฑ ุงููุงูุฏูู ุทุฑูู ุงูุฌูุฉ", "ุฃุฎุชู ุดุฑููุชู ูู ูู ุดู", "ุฃุฎูู ูุง ููุตุฑ ูุนู ุฃุจุฏุงู", "ุฌุฏู ูุญูู ูุตุต ุงููุงุถู ุงูุญูู",
            "ุฌุฏุชู ุชุทุจุฎ ุฃุญูู ุฃูู", "ุงูุนููุฉ ุชุฌุชูุน ูู ุงูููุงุณุจุงุช", "ุฃููู ูุณุนุฏูู ููุฌุงุญู", "ุฃุณุงูุฏ ุฃููู ูู ูู ุงูุธุฑูู",
            "ุฃุฎูู ุงูุตุบูุฑ ุฐูู ูุญุจูุจ", "ุฃุฎุชู ุชุณุงุนุฏูู ูู ูู ุดู", "ุฃูู ุชุฏุนู ูู ูู ููู", "ุฃุจูู ูุนุทููู ูุตุงุฆุญ ุญูููุฉ",
            "ุฃุญุถู ุฃูู ูุฃููู ููุง ุฃุญุจู", "ุฃุณุงุนุฏ ุฃุจูู ูู ุดุบู ุงูุจูุช", "ุฃุนุทู ุฃุฎูู ูู ูุตุฑููู", "ุฃูุถู ููุช ูุน ุฃููู",
            "ุฃุณุชุดูุฑ ุฃููู ูู ูุฑุงุฑุงุชู", "ุฃูุฑุญ ุฃููู ุจูุฌุงุญุงุชู", "ุฃุจุฑ ูุงูุฏูุง ูุฃุทูุนููุง", "ุฃูุฑู ุฃููู ูุฃุญุชุฑููู"
        ]
        return self.generate_smart_variations(base_family, 2000)
    
    def generate_additional_categories(self) -> List[str]:
        """ุชูููุฏ ูุฆุงุช ุฅุถุงููุฉ ูุชููุนุฉ"""
        # ุงูุทุนุงู ูุงูุทุจุฎ
        food_base = [
            "ุทุจุฎุช ูุจุณุฉ ูุฐูุฐุฉ ุนูู ุทุฑููุฉ ุฃูู", "ุดุฑุจุช ุงูุดุงู ูุน ุงูุชูุฑ ูุงูุญููุจ", "ุฃููุช ูุทูุฑ ุณุนูุฏู ุชูููุฏู",
            "ุญุถุฑุช ุนุฒููุฉ ูุทุจุฎุช ุฃููุงุช ุดุนุจูุฉ", "ุฏุนูุช ุงูุฃุตุฏูุงุก ุนูู ุบุฏุงุก ุจูุชู", "ุฌุฑุจุช ูุตูุฉ ุฌุฏูุฏุฉ ูู ุงููุช"
        ]
        
        # ุงูุณูุฑ ูุงูุฃูุงูู
        travel_base = [
            "ุณุงูุฑุช ููุญุฑู ุงูุดุฑูู ูููุจู ูููุงู ุฎุดูุน", "ุฒุฑุช ุงููุฏููุฉ ุงููููุฑุฉ ููุดูุช ูู ุทุฑู ุงูุฑุณูู",
            "ุฑุญุช ุงูุนููุฑ ูุดูุช ุฌูุงู ุงูุณุงุญู", "ุฒุฑุช ุงูุทุงุฆู ูุงุณุชูุชุนุช ุจุงููุฑุฏ", "ุณุงูุฑุช ูุจูุฏ ุฌุฏูุฏ ูุชุนููุช ุซูุงูุชูู"
        ]
        
        # ุงูุตุญุฉ ูุงูููุงูุฉ  
        health_base = [
            "ูุงุฑุณุช ุงูุฑูุงุถุฉ ูู ุงูุตุจุงุญ ูุญุณูุช ุจูุดุงุท", "ุงูุชููุช ุจุตุญุชู ูุฃููุช ุฃูู ุตุญู", "ุดุฑุจุช ูููุฉ ูุซูุฑ ุนุดุงู ุงูุตุญุฉ",
            "ููุช ุจุฏุฑู ุนุดุงู ุฃููู ูุดูุท", "ูุดูุช ูู ุงูุญู ุนุดุงู ุฃุชุญุฑู", "ูุนุจุช ูุฑุฉ ูุฏู ูุน ุงูุฃุตุฏูุงุก"
        ]
        
        # ุงูุชูููุฉ ูุงูุนุตุฑ ุงูุญุฏูุซ
        tech_base = [
            "ุงุณุชุฎุฏูุช ุงูุชุทุจูู ุงูุฌุฏูุฏ ูุฃุนุฌุจูู", "ุชุนููุช ููุงุฑุฉ ุชูููุฉ ุฌุฏูุฏุฉ", "ุดุงุฑูุช ุตูุฑุฉ ุญููุฉ ุนูู ุงูุฅูุณุชูุฑุงู",
            "ุงุชุตูุช ุจุฃููู ุนุจุฑ ุงูููุฏูู ููู", "ูุฑูุช ูุชุงุจ ุฅููุชุฑููู ูููุฏ", "ุชุนููุช ูู ููุฏูู ุชุนูููู ุนูู ุงูููุชููุจ"
        ]
        
        # ุงูุชุฑููู ูุงูููุงูุงุช
        entertainment_base = [
            "ูุฑูุช ุฑูุงูุฉ ุฌูููุฉ ุฎูุชูู ุฃุณุงูุฑ ุจุฎูุงูู", "ุดุงูุฏุช ูููู ููุชุน ูุน ุงูุนุงุฆูุฉ", "ูุนุจุช ูุฑุฉ ูุฏู ูุน ุงูุฃุตุฏูุงุก",
            "ุฑุณูุช ููุญุฉ ุฌูููุฉ ุนุจุฑุช ูููุง ุนู ูุดุงุนุฑู", "ุณูุนุช ููุณููู ูุงุฏุฆุฉ ุชุฑุฎู ุงูุฃุนุตุงุจ", "ูุนุจุช ุฃูุนุงุจ ุงูุทุงููุฉ ูุน ุงูุฃูู"
        ]
        
        # ุงูุฏูู ูุงูุฑูุญุงููุงุช
        religious_base = [
            "ูุฑูุช ุงููุฑุขู ูุญุณูุช ุจุณูููุฉ ุนุฌูุจุฉ", "ุตููุช ูู ุงูุญุฑู ูููุจู ุฎุงุดุน ููู", "ุฏุนูุช ุฑุจู ูู ูู ููุจู",
            "ุชุฃููุช ูู ุฎูู ุงููู ูุดูุช ุนุธูุชู", "ุงุณุชุบูุฑุช ุงููู ูุซูุฑ ูุญุณูุช ุจุงูุฑุงุญุฉ", "ุญูุธุช ุณูุฑุฉ ุฌุฏูุฏุฉ ูู ุงููุฑุขู",
            "ุตููุช ููุงู ุงูููู ููุงุฌูุช ุฑุจู", "ูุฑูุช ูู ูุชุจ ุงูุชูุณูุฑ", "ุณูุนุช ุฎุทุจุฉ ูุคุซุฑุฉ ูู ุงูุฌูุนุฉ"
        ]
        
        additional = []
        additional.extend(self.generate_smart_variations(food_base, 800))
        additional.extend(self.generate_smart_variations(travel_base, 700))
        additional.extend(self.generate_smart_variations(health_base, 800))
        additional.extend(self.generate_smart_variations(tech_base, 700))
        additional.extend(self.generate_smart_variations(entertainment_base, 800))
        additional.extend(self.generate_smart_variations(religious_base, 1200))
        
        return additional
    
    def run_improved_massive_expansion(self) -> Dict[str, int]:
        """ุชุดุบูู ุงูุชูุณูุน ุงูุถุฎู ุงููุญุณู"""
        self._print("๐ ุจุฏุก ุงูุชูุณูุน ุงูุถุฎู ุงููุญุณู ููุงูู ุฅูู 15000+ ุฌููุฉ ูุฑูุฏุฉ")
        self._print("=" * 70)
        
        # ุชุญููู ุงูุญุงูุฉ ุงูุญุงููุฉ
        try:
            with open(self.corpus_path, 'r', encoding='utf-8') as f:
                data = json.load(f)
                current_sentences = set(data.get("sentences", []))
        except:
            current_sentences = set()
        
        initial_count = len(current_sentences)
        self._print(f"๐ ุงูุฌูู ุงูุญุงููุฉ: {initial_count}")
        
        # ุชูููุฏ ุฌูู ุฌุฏูุฏุฉ ูุชูุฏูุฉ
        all_new_sentences = []
        
        categories = [
            ("ุงูุญูุงุฉ ุงูููููุฉ", self.generate_daily_life_massive),
            ("ุงููุดุงุนุฑ ุงููุชูุฏูุฉ", self.generate_emotions_massive), 
            ("ุงูุชูุงุนูุงุช ุงูุงุฌุชูุงุนูุฉ", self.generate_social_massive),
            ("ุงูุชุนุจูุฑุงุช ุงูุซูุงููุฉ", self.generate_cultural_massive),
            ("ุงูุนูู ูุงูุชุนููู", self.generate_work_education_massive),
            ("ุงูุนูุงูุงุช ุงูุนุงุฆููุฉ", self.generate_family_massive)
        ]
        
        for category_name, method in categories:
            self._print(f"๐ ุชูููุฏ ุฌูู {category_name}...")
            category_sentences = method()
            all_new_sentences.extend(category_sentences)
            self._print(f"   โ ุชู ุชูููุฏ {len(category_sentences)} ุฌููุฉ")
        
        # ุฅุถุงูุฉ ุงููุฆุงุช ุงูุฅุถุงููุฉ
        self._print("๐ ุชูููุฏ ุงููุฆุงุช ุงูุฅุถุงููุฉ...")
        additional_sentences = self.generate_additional_categories()
        all_new_sentences.extend(additional_sentences)
        self._print(f"   โ ุชู ุชูููุฏ {len(additional_sentences)} ุฌููุฉ ุฅุถุงููุฉ")
        
        # ุชุตููุฉ ููุนุงูุฌุฉ ุงูุฌูู
        self._print("๐ ุชุตููุฉ ููุนุงูุฌุฉ ุงูุฌูู ุงูุฌุฏูุฏุฉ...")
        processed = self.process_and_filter_sentences(all_new_sentences)
        
        # ุฅุถุงูุฉ ุงูุฌูู ุงููุฑูุฏุฉ ููุท
        added_count = 0
        for sentence in processed:
            if sentence not in current_sentences and len(sentence.strip()) > 5:
                current_sentences.add(sentence.strip())
                added_count += 1
        
        # ุญูุธ ุงููุชุงุฆุฌ
        final_sentences = list(current_sentences)
        updated_data = {"sentences": final_sentences}
        
        with open(self.corpus_path, 'w', encoding='utf-8') as f:
            json.dump(updated_data, f, ensure_ascii=False, indent=2)
        
        final_count = len(final_sentences)
        
        self._print("๐ ุงูุชูู ุงูุชูุณูุน ุงูุถุฎู ุงููุญุณู!")
        self._print(f"โจ ุงูุฌูู ุงููุถุงูุฉ ุงูุฌุฏูุฏุฉ: {added_count}")
        self._print(f"๐ ุฅุฌูุงูู ุงูุฌูู: {final_count}")
        self._print(f"๐ ูุณุจุฉ ุงูููู: {((final_count - initial_count) / max(initial_count, 1) * 100):.1f}%")
        
        if final_count >= self.target_sentences:
            self._print("โ ุชู ุชุญููู ุงููุฏู ุจูุฌุงุญ!")
        else:
            remaining = self.target_sentences - final_count
            self._print(f"โก ูุชุจูู {remaining} ุฌููุฉ ูุชุญููู ุงููุฏู ุงููุงูู")
        
        return {
            "initial_count": initial_count,
            "added_count": added_count,
            "final_count": final_count,
            "target_achieved": final_count >= self.target_sentences,
            "growth_percentage": ((final_count - initial_count) / max(initial_count, 1) * 100)
        }

if __name__ == "__main__":
    print("๐ ูุธุงู ุงูุชูุณูุน ุงูุถุฎู ุงููุญุณู ููุงูู")
    print("=" * 50)
    
    expansion_system = ImprovedMassiveExpansion(target_sentences=15000, verbose=True)
    results = expansion_system.run_improved_massive_expansion()
    
    print(f"\n๐ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ:")
    for key, value in results.items():
        if isinstance(value, float):
            print(f"   {key}: {value:.1f}")
        else:
            print(f"   {key}: {value}")
    
    if results["target_achieved"]:
        print("\n๐ ูุจุฑูู! ุชู ุชุญููู ุงููุฏู ุจูุฌุงุญ!")
        print("๐ฅ ูุงูู ุงูุขู ูุฏูู ุฃูุซุฑ ูู 15000 ุฌููุฉ ุชุฏุฑูุจูุฉ ุนุงููุฉ ุงูุฌูุฏุฉ!")
    else:
        print(f"\nโก ุฅูุฌุงุฒ ุฑุงุฆุน! ุชู ุฅุถุงูุฉ {results['added_count']} ุฌููุฉ ุฌุฏูุฏุฉ")
        print("๐ ูููู ุชุดุบูู ุงููุธุงู ูุฑุฉ ุฃุฎุฑู ูุฅุถุงูุฉ ุงููุฒูุฏ")